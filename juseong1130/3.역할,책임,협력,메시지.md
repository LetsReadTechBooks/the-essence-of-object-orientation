먼저 한 가지 예시를 보고 가겠습니다.
우리가 커피 한잔을 주문하는 일을 한다고 할 때 손님은 캐셔에게 주문하고 캐셔는 바리스타에게 커피를 만들어 달라 요청합니다. 우리가 사는 현실에서 이런 커피 주문 같은 작은 이벤트에도 각자의 책임을 가지고 역할을 다하며 협력하여 문제를 해결해 나갑니다. 객체 세계라고 다를까요? 그렇지 않습니다.   
객체 세계에서도 역할,책임,협력을 통해 원하는 목표를 해결하려 노력합니다. 원하는 목표를 이루기 위해 현실에서도 객체 세계에서도 중요한 역할,책임,협력에 대해서 알아봅시다.  

---

## 협력

#### 어떠한 객체도 섬이 아니다

객체는 애플리케이션의 기능을 구현하기 위해 존재하는데 아주 작은 기능조차 객체혼자 감당하기에는 버거울 정도로 복잡하고 거대합니다. 그래서 일반적으로는 객체끼리 특정한 목적을 이루기위해 서로 협력을 통해 기능을 구현하게됩니다.

- 객체는 자신에게 주어진 책임을 완수하기 위해 다른 객체를 이용하고 서비스를 제공한다. 
- 객체는 다른 객체와 적극적으로 상호작용하며 협력하는 객체들의 공동체에 참여하기 위해 노력한다.

#### 협력이란 무엇일까요?
협력은 서로 도와 무언가를 해결하는것으로 알고 있습니다. 여기서 협력이란 바로 요청과 응답을 말하는것입니다. 손님이 캐셔에게 요청하면 캐시어는 바리스타에게 요청하든 자기가 만들던 자기만의 방식을 선택해 커피를 만들어주게됩니다. 이런 서로 각자가 할 수 있는일을 진행하며 도와 협력하면 커피를 주문하는 목적을 달성하게됩니다. 이것을 바로 협력이라볼 수 있습니다.

협력의 핵심은 특정한 책임을 수행하는 역할들 간의 연쇄적인 요청과 응답을 통해 목표를 달성하는것이며 목표는 사람들의 협력을 통해 달성됩니다.
이때 목표는 더 작은 책임으로 분할 될 수 있고 분할된것 중 책임을 수행할 수 있는 적절한 역할을 가진 사람에게 배정되어 수행되는것입니다.

예를들어 집을 짓는다 가정하면 손님은 건설사에게 집을 지어줘라고 요청하면 건설사는 설계를 할 설계자, 시공을 할 수 있는 시공팀들 등등의 여러 특정한 책임들을 수행하는 사람들이 모여 집이라는 목표를 달성하기 위해 협력하게 됩니다.


#### 그런데 인간은 타인에게 도움을 요청하기위해 다양한 방법이 있습니다.(말 몸짓 등등)  객체는 다른 객체에게 어떻게 요청을 해야할까요? 

<U>바로 메시지란것을 통해 서로에게 요청하고 응답을 하게됩니다.</U>

여기서 객체가 수신된 메시지를 처리하는 방법을 메서드라고 부르며 메시지를 수신한 객체가 실행시간에 메서드를 선택할 수 있다는 점은 다른 프로그래밍 언어와 객체지향 언어를 구분하는 핵심중에하나입니다.

메시지와 메서드 분리는 객체의 협력에 참여하는 객체들 간의 자율성을 증진시킵니다.   
(자기만의 구현방법을 선택할 수 있는 자율성)  
(커피 제조요청이 메시지 커피를 제조하는 구체적인 방법이 메서드)


#### 객체 세계에서는 협력이라는 문맥을 무시한체 각 객체의 반응을 독립적으로 예상하고 관찰하는것은 무의미 합니다. 왜 무의미할까요?

최후통첩 게임이란것으로 인간의 심리를 테스트한적이 있습니다. 인간은 각각의 인간은 이기적이고 합리적인 존재라고 예상했지만 인간은 각자의 처해있는 정황이나 문맥에 따라 행동방식이 결정되었습니다. (여기서 문맥은 타인과의 협력을 의미합니다)

여기서 보다 싶이 인간을 개개인으로 바라보아 이기적인 존재로 봤지만 문맥에 따라 행동이 달라지게 되었는데 객체도 똑같이 다른 객체와의 협력 없이 개개인의 객체를 바라보는것은 문맥에 따라 달라지는 객체를 제대로 바라보지 못하게 되기 때문에 무의미 하다 하는것입니다. 

그래서 다른 객체를 바라볼때는 다른 객체와 협력을할때 협력이 얼마나 적절한지에 따라 행동의 적합성이 결정되며 즉 협력이라는 문맥이 객체의 행동방식을 결정하는것입니다.


> 객체지향에 갓 입문한 사람들의 가장 흔한 실수는 협력이라는 문맥을고려하지 않은채 객체가 가져야할 상태와 행동부터 고려한다는 것입니다. 중요한것은 개별객체가아니라 객체들 사이에 이뤄지는 협력이며 객체지향 설계의 전체적인 품질은 각 객체의 품질이 아니라 여러객체들이 모여 이뤄내는 협력의 품질이라는 것을 기억하셨으면 좋겠습니다. (어떤 협력에 참여하는지가 객체에 필요한 행동을 결정하고 필요한 행동이 객체의상태를 결정한다.)

---

## 역할과 책임

#### 역할이란?

사람들은 다른사람과 협력하는 과정속에서 특정한 역할(role)을 부여받게 됩니다. 여기서 손님에게 주문을 받는 사람은 캐셔라는 특정한 역할을 부여 받게 되는것입니다.

역할이 의미하는것
- 여러사람이 동일한 역할 수행가능 ex) A,B,C라는 사람이 캐셔 가능
- 대체가능성을 의미 ex) 캐셔1이란 역할에 A가 하고있었는데 B가 할 수 있음
- 책임을 수행하는 방법은 자율적으로 선택가능 ex) 자신만의 독특한 방법으로 커피제조 = 다형성
- 한사람이 동시에 여러역할 수행가능 ex) 회사에 출근하면 사원 집에서는 아버지

객체지향 프로그래밍에 경험이 많은 사람들도 역할의 중요성을 간과하는데 역할은 유연하고 재사용가능한 협력관계를 구축하는데 중요한 설계요소입니다.  이유는 바로 역할은 대체가능하고 수행하는 방식을 선택할 수 있다는 점이 주요한데 자동차라는 역할이 있다고 할때 자동차의 엔진을 바꿔야한다고 했을때 다른 엔진의 역할을 수행할 수 있는 것들을 가져온다면 자동차는 제네시스가 되든 벤츠가되던 그런것들에 상관없이 자동차란 역할에 의해 유연하게 변경이 가능하게 만들어줍니다.  

동일한 역할을 수행하는 객체들이 동일한 메시지를 수신할 수 있기때문에 동일한 책임을 수행할 수 있다는것은 매우 중요한 개념입니다.



#### 책임이란?
 
책임은 역할안에 포함되어있는것들을 말합니다. 캐셔는 주문을 받을 수 도 있으며 청소를 할 수 도있고 하는등의 자기만의 책임들이 있을 수 있습니다. 캐셔는 주문을 받게되면 그 책임을 다해 커피를 제공하게됩니다.

 즉 캐셔만의 책임이 존재하게되며 이러한 책임들이 모여 역할이란것이 되는것입니다.  (역할과 책임은 협력이 원할하게 진행되는데 필요한 핵심적인 구성요소)

어떤 객체들이 특정한 요청을 받아들일 수 있는 이유는 그 요청에 대한 적절한 방식으로 응답하는데 필요한 지식과 행동방식을 가지고 있기때문이다. (그 요청에 대한 응답을 하는 책임이 있다는 것이다.)  
누군가 왕에게 재판을해달라는 요청은왕은 재판을 수행할 의무가 있으며 재판에 필요한 지식을 가지고 있음을 의미한다. 이 의미는 왕은 그 책임이 있다라고 해석해도 좋다. 즉 어떤 요청에 대해 대답해 줄 수 있거나 적절한 행동을 할 의무가 있는 경우 해당객체가 책임을 가진다고 말한다

#### 책임,메시지 그리고 인터페이스
객체의 책임을 이야기할때는 일반적으로 외부에서 접근가능한 공용서비스의 관점에서 이야기한다.

즉 책임은 객체의 외부에 제공해줄 수 있는 정보(아는것의 측면)와 외부에 제공해줄수 있는 서비스(하는것의 측면)의 목록이다. ( 내가 아는 정보를 전달 해주는 책임 예를들어 증언하라는 책임이면 증언할 내용에 대해 아는것 , 어떤것을 서비스 하는 책임은 하얀토끼에게 증언자를 불러와라 하면 증언자(다른 사람)를 불러 주는것 책임을 두가지로 나누면 이 두가지 책임이 있다는것) 

따라서 책임은 객체의 공용 인터페이스를 구성합니다.

#### 책임을 능숙하게 할당하는 방법

객체지향 개발에서 가장 중요한 능력은 책임을 능숙하게 소프트웨어 객체에 할당하는것이라고 말합니다.

⭐ 도대체 어떻게 해야될까요?  
책임을 능숙하게 소프트웨어하기 위해서는 문맥에 따라 행동을 정하고 행동이 들어갈 객체를 정해야한다. 이렇게해야 유연하고 재사용성이 높은 소프트웨어가 작성되며 책임을 어떻게 구현할지는 객체와 책임이제자리를 잡은 후에 고려해도 늦지 않는다.  (여기서 문맥은 타인과의 협력을 의미합니다)

상태중심이 아닌 행동중심의 설계를 해야하며 그리고 행동 중심을 설계할때는 문맥에 따라 행동을 정해야하고 이후 적절한 책임(행동)을 가지는 객체를 선택하게 되는것이다.

객체와 책임이 이리저리 부유하는 상황에서 성급하게 뛰어드는 것은 변경에 취약하고 다양한 협력에 참여할 수 없는 비 자율 적인 객체를 낳게된다. 

객체지향이란 예술은 적절한 객체에게 적절한 책임을 할당하는것에서 시작됩니다 책임이 불분명한 객체는 애플리케이션의 미래역시 불분명하게 만든다. 얼마나 적절한 책임을 선택하느냐가 애플리케이션의 아름다움을 결정합니다.


#### 책임의 캡슐화

> 객체지향 애플레키이션의 윤곽을 결정하는것은 역할 책임 협력이지만 실제로 협력에 참여하는 주체는 객체라는 사실은 잊지 않으셨으면 좋겠습니다.

---

### 정리

저는 예전에는 문맥에 따라 행동 중심적인 설계를 하는것이 아닌 각각의 객체만을 바라보고 상태 중심적인 설계를 하면서 객체지향 설계를 했었다. 그렇게 하니 당연히 객체지향 설계는 순탄하지 못하였고 애매모호하고 답답한 부분이 많았는데 위의 내용을 읽으며 내가 답답하게 느꼈던 부분을 많이 찾게 되었고 아래와 같이 객체를 설계하면 좋겠구나란 생각을 가지게 되었습니다.

어떤 소프트웨어를 만들때 기능이 필요하다면 요청과 응답을 통한 협력을 구상하고 이후 이 요청과응답을 적절한 객체에게 메시지(책임,행동)로 할당하여 각자의 객체가 적절한 책임을 가지고 이를 통해 협력하는 객체를 만들어 우아한 객체 설계를 하고 싶습니다.  

객체지향 세계에서는 복잡한 기능을 단순화 하기위해 객체끼리 협력하며 이 협력을 진행하기 위해 필요한 책임을 찾아 할당 해야합니다.
할당은 역할에 되게 되는데 역할은 여러가지 책임이 모여 만들어 진것이며 협력을 쉽게 이해할 수 있게 합니다. 

---
### 부록

#### 책임의 분류
책임은 객체에 의해 정의되는 응집도 있는 행위의 집합으로 객체가 알아야 하는 정보와 객체가 수행할 수 있는 행위에 대해 개략적으로 서술한 문장입니다.

즉 객체가 무엇을 알고있는가(knowing)와 무엇을 할 수 있는가(doing)로 구성됩니다.

- 하는것
	- 객체를 생성하거나 계산을하는등의 스스로 하는것
	- 다른 객체의 행동을 시작 시키는것
	- 다른 객체의 활동을 제어하고 조절하는것 
- 아는 것
	- 개인적인 정보에 관해 아는것
	- 관련된 객체에 관해 아는것
	- 자신이 유도하거나 계산할 수 있는것에 관해아는것  

정리해 보자면
- 자율적으로 아는것을 바탕으로  책임을 다하는것을 말한다 예를들어 증언하라라고 했을때 객체는 자기가 아는것을 바탕으로 증언이라는 책임을 다한다.
- 자율적으로 행동을하는것을 말한다. 두가지 예시가 있는데 하얀토끼에게 증인을 불러오라 할 수 있고 그리고 증인요청을 받은 객체는 자율적으로 증인석에 나가거나 안나가거나 할 수있다.

쉽게말해 객체의 책임은 아는것을 바탕으로 요청하거나 스스로 행동하는것이라 말할 수 있을거 같다.

#### 책임과 메시지

위 협력 파트에서 다른 사람과 의사소통 하기 위해 메시지를 이용한다 하였습니다. 그런데 책임과 메시지는 어떤 관계에 있을까요?

책임이 협력이라는 문맥속에서 요청을 수신하는 한쪽의 객체 관점에서 무엇을 할 수 있는지 나열하는것이라면 메시지는 협력에 참여하는 두 객체 사이의 관계를 강조한것입니다.

책임의 관점에서 모자장수는 증언을 해야할 책임이 있는데 이것은 객체의 존재 여부와 상관없이 모자 장수가 외부에 제공할 수 있는 행위의 일부입니다.

반면에 메시지라고 이야기 할떄는 항상 메시지를 전송하는 객체와 메시지를 수신하는 객체가 상호 협력하는 문맥을 강조합니다. 왕은 전송하라는 메시지를 전송할 수 있고 모자장수는 증언하라는 메시지를 수신할 수 있다.

즉 책임은 어떤 특정 한 사람의 이야기라면 메시지는 서로가 가지고 있는 책임에 대해 요청하며 상호 작용할 때 의사소통하기 위한 개념이라 할 수 있을 거 같습니다.

책임과 메시지의 수준은 같지 않으며 책임은 객체가 협력에 참여하기 해 수행해야하는 행위를 상위 수준에서 개략적으로 서술한것입니다.

책임을 결정한 후 실제로 협력을 정제하면서 이를 메시지로 변환할때는 하나의 책임이 여러 메시지로 분활 되는것이 일반적입니다.  
비슷한 말로 시스템의 기능은 더작은 규모의 책임으로 분할되고 각 책임은 책임을 수행할 적절한 객체에게 할당된다.라는 말이 있습니다.

잘 이해가지 않는다면 분해를 통해 적절한 할당을 하여 이를 통해 응집도를 높이고 복잡성을 줄인다 정도로만 이해하고 넘어가도 좋습니다.

그런데 위의 글을 읽고나면 책임과 메시지가 다른 개념이다라고 생각하시는분들도 많을거같습니다. 그런데 메시지가 책임을 의미한다 했던것을 기억하라. 결국 동일한 역할을 수행할 수 있는것은 해당 객체들 협력내에서 동일한 책임의 집합을 수행할 수 있다는것을 의미한다.  
책 내용중에는 이런 글도 있어 참애매 모호합니다.

정리해 보자면 그냥 책임 == 메시지다라고 생각하고 넘어가도 될듯하며 저는 협력에 참여하기 위해 행위를 개략적으로 서술한것이 책임인데 이 개략적인 책임을 구체적인 모양으로 만들기위해 메시지형태를 지정하게 되었다라고 생각합니다. 책임의 모양을 만들면 메시지가 나오게됨  
책임은 그 객체가 할 수 있는것이고 메시지는 그객체에게 그 행동 해달라고 메시지를 보내는것이라고 생각을함


#### 협력의 추상화 = 역할
어떤 객체가 수행하는 책임의 집합은 객체가 협력안에서 수행하는 역할을 암시합니다.  
예를들어 왕은 재판을 진행하는 책임을 가지며 판사라는 역할을 암시하게 됩니다.


⭐ 그냥 왕은 왕인데 재판을 할 수 있다 하지 역할이란 것으로 부르는 이유가 뭘까요?
그것은 역할이 재 사용 가능하고 유연한 객체 지향 설계를 낳는 매우 중요한 구성 요소이기 때문입니다.   
또한 판사와 증인이라는 역할을 사용하면 다른 상황이 주어져도 역할에서 나오는 개념을 통해 어떤 일을 할지 쉽게 추측할 수 있게 됩니다.  (협력의 추상화는 설계자가 다뤄야하는 협력의 개수를 줄이는 동시에 구체적인 객체를 추상적인 역할로 대체함으로써 협력의 양상을 단순화합니다. )

즉 역할의 개념을 사용하면 유사한 협력을 추상화해서 인지 과부화를 줄여줄 수 있습니다.  
역할은 객체지향 설계의 단순성,유연성,재사용성을 뒷받침하는 핵심개념입니다.

⭐ 그래서 협력의 추상화가 뭐에요?
협력을 추상화한다는 것은 협력의 복잡한 세부 사항을 숨기고 핵심적인 개념과 역할에 집중하여 표현하는 것을 의미합니다. 즉, 협력의 핵심적인 부분을 간결하게 정의하고 이해하기 쉽게 만드는 것을 말합니다. (협력을 역할을 이용해 추상화하여 저 협력은 어떤일을 하는지 이해하기 쉽게 만든다는것이 장점인거 같습니다.)

예를 들어, 모자장수가 증인 왕의 판사의 역할을 수행하는 객체들이 협력에 참여해야 한다고 가정해보겠습니다. 이때 이들의 협력을 추상화한다는 것은 모자장수와 왕을 오로지 "판사"와 "증인"이라는 추상적인 역할로만 생각하는 것입니다. 실제로 그들이 어떤 동작을 수행하거나 어떤 정보를 가지고 있는지는 중요하지 않습니다. 대신, 각각의 역할이 협력 내에서 어떤 역할을 하는지, 어떤 메시지를 주고 받아야 하는지, 어떻게 상호 작용해야 하는지를 중점적으로 이해하는 것입니다. 이런 추상화를 통해 협력의 복잡성을 다루기 쉬워지며, 구체적인 구현 세부 사항에 영향받지 않고도 역할 간의 상호작용을 이해하고 설계할 수 있습니다. 이는 소프트웨어 개발에서 객체 지향 프로그래밍 등에서도 활용되는 개념으로, 시스템을 모듈화하고 유연하게 만들어 유지보수와 확장을 용이하게 합니다.

⭐ 협력의 추상화로 무엇을 얻을 수 있나요?
역할을 이용해 협력을 추상화 했기때문에 판사나 증인의 역할을 수행할 수 있는 어떤 객체라도 협력에 참여할 수 있습니다. 단  역할을 대체할 수 있는 객체는 동일한 메시지를 이해할 수 있는 객체로 한정됩니다.

역할이 협력을 추상적으로 만들 수 있는 이유는 역할 자체가 추상화이기 때문입니다.

#### 역할에 맞지 않는 책임

만약 요구사항을 개발할때 역할에 맞지않는 책임이 있다면 어떻게 해야될까요?

객체가 역할에 주어진 책임 이외에 다른 책임을 수행할 수 도 있습니다.
왕은 재판을 할 책임 뿐만아니라 국정을 돌봐야할 추가 적인 책임을 따를 수 도 있으며
결국 객체는 역할이 암시하는 책임보다 더많은 책임을 가질 수 있습니다. 따라서 대부분의 경우에 객체의 타입과 역할 사이에는 일반화/특수화 관계를 통해 해결합니다.
예를 들어 일반적인 트럼프라는 역할은 걷지 못합니다. 그래서 특수한 책임을 트럼프 인간이란 것을 생성해 이를 해결합니다. 아것이 특수화입니다.

#### 흔한오류

첫번쨰로 많은 사람들이 시스템에 필요한 데이터를 저장하기위해 객체가 존재한다는 선입견이 있습니다.

물론 객체가 상태의 일부로 데이터를 포함하는것은 사실이지만데이터는 단지 객체가 행위를 수행하는데 필요한 재료일 뿐입니다.

두번째는 선입견은 객체지향이 클래스와 클래스 간의 관계를 표현하는 시스템의 정적인 측면에 중점을 둔다는것이다.

중요한것은 정적인 클래스가 아니라 협력에 참여하는 동적인 객체이며 클래스는 단지 시스템에 필요한 객체를 표현하고 생성하기 위해 프로그래밍 언어가 제공하는 구현 메키니즘이란 사실을 기억하면 좋습니다.

객체지향의 핵심은 클래스를 어떻게 구현할지가 아니라 객체가 협력안에서 어떤 책임과 역할을 수행할것인지를 결정하는것이다.

객체지향 입문자들이 데이터나 클래스 중심으로 애플리케이션을 설계하는 이유는 협력이라는 문맥을 고려하지 않고 각 객체를 독립적으로 바라보기때문이다.

맨 처음 왕의 떠오르는 모습을 기반으로 클래스를 만들경우 처음에는 전형적인 왕의 모습을 소프트웨어에 객체를 창조하는것이 적절해 보일지는 몰라도 우리가 원하는 요구사항에 맞는 애플리케이션 구축을 위해서는 왕이 참여하는 협력을 우선으로 고려해야합니다.

#### 협력을 따라 흐르는 객체의 책임

올바른 객체를 설계하기 위해서는 먼저 견고하고 깔끔한 협력을 설계해야한다.

협력을 설계한다는것은 설계에 참여하는 객체들이 주고받을 요청과 응답의 흐름을 결정한다는것을 의미한다.

이렇게 결정된 요청과 응답의 흐름은 객체가 협력에 참여하기 위해 수행될 책임이된다.

객체에게 책임을 할당하고 나면 책임은 객체가 외부에 제공하게 될 행동이된다.

협력이라는 문맥에서 객체가 수행하게 될 적절한 책임, 즉 행동을 결정한 후에 그행동을 수행하는데 필요한 데이터를 고민해야한다.

그리고 객체가 협력에 참여하기 위해 필요한 데이터와 행동이 어느정도 결정된 후에 클래스의 구현 방법을 결정해야한다.

앨리스의 이야기에서 누군가는 재판을 진행하고 누군가는 증인을 증인석으로 부른다. 이처럼 협력을 구성하는데 필요한 일련의 책임을 먼저 고안하고 나면 그 책임을 수행하는데 필요한 객체를 선택하게된다.

객체지향이 올바른 객체에 올바른 책임을 할당하는 것과 관련된 모든 것이라면 협력이 라는 문맥 안에서 객체를 생각하는 것은 올바른 객체지향 애플리케이션을 구현하는 것 과 관련된 모든 것이다. 일단 협력이라는 견고한 문맥이 갖춰지면 우리의 초점은 협력 을 위해 필요한 책임의 흐름으로 옮겨진다. 그리고 협력에 필요한 책임을 결정하고 객체에게 책임을 할당하는 과정을 얼마나 합리적이고 적절하게 수행했는지가 객체지향 설계의 품질을 결정한다.

객체의 행위에 초점을 맞추기 위해서는 협력이라는 실행 문맥 안에서 책임을 분배해야 한다. 각 객체가 가져야 하는 상태와 행위에 대해 고민하기 전에 그 객체가 참여할 문맥인 협력을 정의하라. 객체지향 시스템에서 가장 중요한 것은 충분히 자율적인 동시에 충분히 협력적인 객체를 창조하는 것이다. 이 목표를 달성할 수 있는 가장 쉬운 방 법은 객체를 충분히 협력적으로 만든 후에 협력이라는 문맥 안에서 객체를 충분히 자율적으로 만드는 것이다.






